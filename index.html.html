
<!doctype html>
<html lang="de" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kona‑Quali Rechner — Modern</title>

  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Tailwind via CDN -->
  <script>
    // Tailwind config: rounded, shadows, and smooth focus rings
    window.tailwind = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'ui-sans-serif', 'system-ui', 'sans-serif'] },
          boxShadow: {
            soft: '0 10px 30px -10px rgba(2,6,23,0.15)',
            innerGlow: 'inset 0 1px 0 0 rgba(255,255,255,0.5), 0 1px 2px rgba(2,6,23,0.05)'
          },
          colors: {
            brand: {
              50: '#eff6ff',
              100: '#dbeafe',
              200: '#bfdbfe',
              300: '#93c5fd',
              400: '#60a5fa',
              500: '#3b82f6',
              600: '#2563eb',
              700: '#1d4ed8',
              800: '#1e40af',
              900: '#1e3a8a'
            }
          }
        }
      }
    }
  </script>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React & ReactDOM via CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel for JSX in the browser -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    :root{
      color-scheme: light;
    }
    .glass {
      background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.6));
      border: 1px solid rgba(255,255,255,0.6);
      backdrop-filter: blur(8px);
    }
    .gradient-text {
      background: linear-gradient(90deg, #0ea5e9, #22c55e);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .ring-focus:focus{
      outline: none;
      box-shadow: 0 0 0 4px rgba(59,130,246,0.15);
    }
    .card-border {
      position: relative;
    }
    .card-border::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 1.25rem;
      padding: 1px;
      background: linear-gradient(120deg, rgba(59,130,246,0.35), rgba(16,185,129,0.35));
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
              mask-composite: exclude;
      pointer-events: none;
    }
  </style>
</head>

<body class="font-sans bg-gradient-to-br from-sky-50 via-white to-emerald-50 text-slate-900 min-h-screen selection:bg-brand-200/60">
  <div class="absolute inset-x-0 -top-24 -z-10 blur-3xl opacity-60">
    <div class="mx-auto h-64 w-11/12 bg-gradient-to-r from-sky-300 via-emerald-300 to-sky-300 rounded-full"></div>
  </div>

  <div id="root"></div>

  <script type="text/babel">
    const { useMemo, useState } = React;

    // ===================== Hilfsfunktionen =====================
    function hmsToSeconds(hms) {
      const parts = hms.split(":").map((p) => p.trim());
      if (parts.length === 0) return 0;
      let h = 0, m = 0, s = 0;
      if (parts.length === 3) {
        h = Number(parts[0]) || 0;
        m = Number(parts[1]) || 0;
        s = Number(parts[2]) || 0;
      } else if (parts.length === 2) {
        h = Number(parts[0]) || 0;
        m = Number(parts[1]) || 0;
      } else if (parts.length === 1) {
        h = Number(parts[0]) || 0;
      }
      return Math.max(0, h) * 3600 + Math.max(0, m) * 60 + Math.max(0, s);
    }

    function secondsToHms(total) {
      if (!isFinite(total) || total <= 0) return "00:00:00";
      const h = Math.floor(total / 3600);
      const m = Math.floor((total % 3600) / 60);
      const s = Math.round(total % 60);
      const pad = (n) => n.toString().padStart(2, "0");
      return `${pad(h)}:${pad(m)}:${pad(s)}`;
    }

    // ===================== Daten =====================
    const AGE_GROUPS = ["18-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70-74","75-79","80+"];
    const GENDERS = ["Männer", "Frauen"];

    const DEFAULT_FACTORS = {
      "Männer": {"18-24":1.03,"25-29":1.01,"30-34":1.0,"35-39":0.99,"40-44":0.97,"45-49":0.95,"50-54":0.92,"55-59":0.89,"60-64":0.86,"65-69":0.83,"70-74":0.80,"75-79":0.76,"80+":0.72},
      "Frauen": {"18-24":1.02,"25-29":1.01,"30-34":1.0,"35-39":0.985,"40-44":0.965,"45-49":0.94,"50-54":0.905,"55-59":0.87,"60-64":0.835,"65-69":0.80,"70-74":0.765,"75-79":0.73,"80+":0.69}
    };

    const DEFAULT_RACES = [
      { name: "IRONMAN Switzerland 2025", thresholdSeconds: hmsToSeconds("09:03:00") },
      { name: "IRONMAN Sweden 2025", thresholdSeconds: hmsToSeconds("08:57:00") },
      { name: "IRONMAN Wisconsin 2025", thresholdSeconds: hmsToSeconds("09:27:00") },
    ];

    // ===================== UI‑Bausteine =====================
    const Section = ({children}) => (
      <section className="glass card-border rounded-2xl shadow-soft p-6 md:p-8">{children}</section>
    );

    const LabelRow = ({ label, children }) => (
      <div className="grid grid-cols-12 items-center gap-3">
        <div className="col-span-12 md:col-span-4 text-sm text-slate-600">{label}</div>
        <div className="col-span-12 md:col-span-8">{children}</div>
      </div>
    );

    const Segmented = ({ options, value, onChange }) => (
      <div className="inline-flex rounded-xl bg-white p-1 border border-slate-200 shadow-inner">
        {options.map(opt => (
          <button
            key={opt}
            onClick={() => onChange(opt)}
            className={(value===opt)
              ? "px-4 py-2 rounded-lg bg-gradient-to-r from-sky-500 to-emerald-500 text-white font-medium shadow"
              : "px-4 py-2 rounded-lg text-slate-700 hover:bg-slate-50 transition"}
          >
            {opt}
          </button>
        ))}
      </div>
    );

    const Kpi = ({label, value, sub}) => (
      <div className="rounded-xl p-5 bg-white shadow-innerGlow">
        <div className="text-xs uppercase tracking-wide text-slate-500">{label}</div>
        <div className="mt-1 text-4xl md:text-5xl font-extrabold font-mono gradient-text">{value}</div>
        {sub && <div className="text-xs text-slate-500 mt-1">{sub}</div>}
      </div>
    );

    // ===================== App =====================
    function App() {
      const [gender, setGender] = React.useState("Männer");
      const [ageGroup, setAgeGroup] = React.useState("35-39");
      const [timeStr, setTimeStr] = React.useState("11:30:00");

      const [races] = React.useState(DEFAULT_RACES);
      const factors = DEFAULT_FACTORS;

      const inputSeconds = hmsToSeconds(timeStr);
      const factor = (factors[gender] && factors[gender][ageGroup]) ?? 1;
      const ageGradedSeconds = Math.round(inputSeconds * factor);

      const comparison = races
        .map((r) => ({
          name: r.name,
          thresholdSeconds: r.thresholdSeconds,
          diff: ageGradedSeconds - r.thresholdSeconds,
          qualifies: ageGradedSeconds <= r.thresholdSeconds,
        }))
        .sort((a, b) => a.thresholdSeconds - b.thresholdSeconds);

      return (
        <div className="relative">
          <header className="max-w-6xl mx-auto px-4 pt-10 pb-6">
            <h1 className="text-3xl md:text-5xl font-extrabold tracking-tight">
              Kona‑Quali <span className="gradient-text">Rechner</span>
            </h1>
            <p className="mt-2 text-slate-600 max-w-2xl">
              Vergleiche Deine Ironman‑Zeit altersklassen‑bereinigt (Age‑Graded) und sieh auf einen Blick,
              wie weit Du von typischen Quali‑Schwellen entfernt bist.
            </p>
          </header>

          <main className="max-w-6xl mx-auto px-4 pb-16 space-y-6">
            {/* Eingaben */}
            <Section>
              <div className="grid md:grid-cols-3 gap-6 items-end">
                <div className="md:col-span-1 space-y-4">
                  <LabelRow label="Geschlecht">
                    <Segmented options={GENDERS} value={gender} onChange={setGender} />
                  </LabelRow>

                  <LabelRow label="Altersklasse">
                    <select
                      value={ageGroup}
                      onChange={(e) => setAgeGroup(e.target.value)}
                      className="w-full md:w-auto px-4 py-2 rounded-xl border border-slate-200 bg-white ring-focus"
                    >
                      {AGE_GROUPS.map((ag) => (
                        <option key={ag} value={ag}>{ag}</option>
                      ))}
                    </select>
                  </LabelRow>

                  <LabelRow label="Deine Ironman‑Zeit">
                    <div className="flex items-center gap-2">
                      <input
                        value={timeStr}
                        onChange={(e) => setTimeStr(e.target.value)}
                        placeholder="hh:mm:ss"
                        inputMode="numeric"
                        className="w-full md:w-48 px-4 py-2 rounded-xl border border-slate-200 bg-white font-mono tracking-wide ring-focus"
                      />
                      <span className="text-xs text-slate-500">Format: 10:45:30</span>
                    </div>
                  </LabelRow>
                </div>

                {/* KPI */}
                <div className="md:col-span-2 grid sm:grid-cols-2 gap-4">\n  <Kpi label="Age‑Graded Time" value={secondsToHms(ageGradedSeconds)} sub={`Faktor ×${factor.toFixed(3)}`} />\n</div>
              </div>
            </Section>

            {/* Vergleich */}
            <Section>
              <h2 className="text-lg font-semibold mb-4">Quali‑Schwellen (Beispiele)</h2>
              <div className="grid md:grid-cols-2 gap-4">
                {comparison.map((c) => (
                  <div key={c.name} className="rounded-xl border border-slate-200 bg-white p-4 shadow-soft flex items-center justify-between">
                    <div>
                      <div className="font-medium">{c.name}</div>
                      <div className="text-xs text-slate-500 mt-0.5">Grenzwert <span className="font-mono">{secondsToHms(c.thresholdSeconds)}</span></div>
                    </div>
                    <div className={(c.qualifies ? "text-emerald-700" : "text-rose-700") + " text-sm font-medium"}>
                      {c.qualifies ? "im Rahmen" : "fehlend"} {c.qualifies ? "✓" : "✗"}
                      <div className="text-xs text-slate-500 text-right">
                        {c.qualifies ? `Puffer ${secondsToHms(Math.abs(c.diff))}` : `noch ${secondsToHms(Math.abs(c.diff))}`}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </Section>

            {/* Tabelle */}
            <Section>
              <h2 className="text-lg font-semibold mb-4">Age‑Graded Time je Altersklasse</h2>
              <div className="overflow-x-auto rounded-xl border border-slate-200 bg-white">
                <table className="min-w-full text-sm">
                  <thead>
                    <tr className="bg-slate-50 text-left text-slate-600">
                      <th className="py-3 px-4">AK</th>
                      <th className="py-3 px-4">{gender}</th>
                    </tr>
                  </thead>
                  <tbody>
                    {AGE_GROUPS.map((ag, idx) => {
                      const f = (DEFAULT_FACTORS[gender] && DEFAULT_FACTORS[gender][ag]) ?? 1;
                      const sec = Math.round(inputSeconds * f);
                      return (
                        <tr key={ag} className={idx % 2 ? "bg-white" : "bg-slate-50/50"}>
                          <td className="py-2.5 px-4">{ag}</td>
                          <td className="py-2.5 px-4 font-mono">
                            {secondsToHms(sec)} <span className="text-xs text-slate-400">(×{f.toFixed(3)})</span>
                          </td>
                        </tr>
                      );
                    })}
                  </tbody>
                </table>
              </div>
            </Section>
          </main>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
